{% extends 'base.html' %}

{% block content %}
<div class="chat-container">
    <div class="chat-list">
        <h2>Ваши чаты</h2>
        <ul>
            {% for chat in recent_messages %}
            <li class="{% if chat.unread_count %}unread{% endif %}">
                <a href="{% url 'chat_with_user' chat.user.id %}">
                    {{ chat.user.username }}
                    {% if chat.unread_count %}
                        <span class="badge">{{ chat.unread_count }}</span>
                    {% endif %}
                    <p class="last-message">{{ chat.last_message.text|truncatechars:30 }}</p>
                    <small>{{ chat.last_message.timestamp|timesince }} назад</small>
                </a>
            </li>
            {% empty %}
            <li>У вас пока нет сообщений</li>
            {% endfor %}
        </ul>
    </div>
    <div class="chat-empty">
        <p>Выберите чат для начала общения</p>
    </div>
</div>
{% endblock %}